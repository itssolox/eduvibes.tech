<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Solox - Universal Social Media Downloader</title>
    
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script>
        // Simple utility to replace clsx/tailwind-merge
        function cn(...classes) {
            return classes.filter(Boolean).join(' ');
        }
    </script>

    <script>
        tailwind.config = {
            darkMode: ["class"],
            theme: {
                container: { center: true, padding: "2rem", screens: { "2xl": "1400px" } },
                extend: {
                    colors: {
                        border: "hsl(240 10% 15%)",
                        input: "hsl(240 10% 15%)",
                        ring: "hsl(186 100% 50%)",
                        background: "hsl(240 40% 3%)",
                        foreground: "hsl(0 0% 98%)",
                        primary: { DEFAULT: "hsl(186 100% 50%)", foreground: "hsl(240 40% 3%)" },
                        secondary: { DEFAULT: "hsl(285 100% 50%)", foreground: "hsl(0 0% 98%)" },
                        destructive: { DEFAULT: "hsl(0 72% 50%)", foreground: "hsl(0 0% 98%)" },
                        muted: { DEFAULT: "hsl(240 10% 15%)", foreground: "hsl(240 5% 65%)" },
                        accent: { DEFAULT: "hsl(285 100% 50%)", foreground: "hsl(0 0% 98%)" },
                        popover: { DEFAULT: "hsl(240 20% 8%)", foreground: "hsl(0 0% 98%)" },
                        card: { DEFAULT: "hsl(240 20% 6%)", foreground: "hsl(0 0% 98%)" },
                    },
                    borderRadius: { lg: "1rem", md: "calc(1rem - 2px)", sm: "calc(1rem - 4px)" },
                    fontFamily: { sans: ["Inter", "ui-sans-serif", "system-ui", "sans-serif"] },
                    animation: {
                        "accordion-down": "accordion-down 0.2s ease-out",
                        "accordion-up": "accordion-up 0.2s ease-out",
                        "float": "floatOrb 10s infinite ease-in-out",
                        "shimmer": "shimmer 1.5s infinite",
                        "pulse-glow": "pulseGlow 2s infinite",
                        "fade-in-up": "fadeInUp 0.8s cubic-bezier(0.16, 1, 0.3, 1) forwards",
                        "gradient": "gradientShift 5s ease infinite"
                    },
                    keyframes: {
                        floatOrb: { "0%, 100%": { transform: "translate(0, 0)" }, "50%": { transform: "translate(30px, 50px)" } },
                        shimmer: { "0%": { transform: "translateX(-100%)" }, "100%": { transform: "translateX(100%)" } },
                        pulseGlow: { "0%, 100%": { opacity: "0.5" }, "50%": { opacity: "1" } },
                        fadeInUp: { from: { opacity: "0", transform: "translateY(30px)" }, to: { opacity: "1", transform: "translateY(0)" } },
                        gradientShift: { "0%": { backgroundPosition: "0% 50%" }, "50%": { backgroundPosition: "100% 50%" }, "100%": { backgroundPosition: "0% 50%" } }
                    }
                }
            }
        }
    </script>

    <style>
        @import url("https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap");
        
        body {
            background-color: hsl(240 40% 3%);
            color: hsl(0 0% 98%);
            font-family: 'Inter', sans-serif;
        }

        .glass {
            background: hsl(0 0% 100% / 0.05);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid hsl(0 0% 100% / 0.1);
        }

        .text-gradient {
            background: linear-gradient(to right, hsl(186 100% 50%), hsl(285 100% 50%));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .glow-primary { box-shadow: 0 0 20px hsl(186 100% 50% / 0.5); }
        .glow-secondary { box-shadow: 0 0 20px hsl(285 100% 50% / 0.5); }

        .gradient-bg {
            background: linear-gradient(135deg, hsl(285 100% 50%), hsl(186 100% 50%));
            background-size: 200% 200%;
        }

        /* Toast Container */
        .toaster-viewport {
            position: fixed;
            top: 0;
            z-index: 100;
            display: flex;
            max-height: 100vh;
            width: 100%;
            flex-direction: column-reverse;
            padding: 1rem;
        }
        @media (min-width: 640px) {
            .toaster-viewport {
                bottom: 0;
                right: 0;
                top: auto;
                flex-direction: column;
                max-width: 420px;
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, useCallback, createContext, useContext } = React;

        // --- ICONS (Inline SVGs to replace Lucide React) ---
        const IconWrapper = ({ children, className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>{children}</svg>
        );
        const Zap = ({ className }) => <IconWrapper className={className}><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></IconWrapper>;
        const LinkIcon = ({ className }) => <IconWrapper className={className}><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/></IconWrapper>;
        const Clipboard = ({ className }) => <IconWrapper className={className}><rect width="8" height="4" x="8" y="2" rx="1" ry="1"/><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"/></IconWrapper>;
        const Play = ({ className }) => <IconWrapper className={className}><polygon points="5 3 19 12 5 21 5 3"/></IconWrapper>;
        const Pause = ({ className }) => <IconWrapper className={className}><rect x="6" y="4" width="4" height="16"/><rect x="14" y="4" width="4" height="16"/></IconWrapper>;
        const Volume2 = ({ className }) => <IconWrapper className={className}><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/><path d="M15.54 8.46a5 5 0 0 1 0 7.07"/><path d="M19.07 4.93a10 10 0 0 1 0 14.14"/></IconWrapper>;
        const VolumeX = ({ className }) => <IconWrapper className={className}><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/><line x1="23" x2="17" y1="9" y2="15"/><line x1="17" x2="23" y1="9" y2="15"/></IconWrapper>;
        const Download = ({ className }) => <IconWrapper className={className}><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" x2="12" y1="15" y2="3"/></IconWrapper>;
        const Music = ({ className }) => <IconWrapper className={className}><path d="M9 18V5l12-2v13"/><circle cx="6" cy="18" r="3"/><circle cx="18" cy="16" r="3"/></IconWrapper>;
        const Image = ({ className }) => <IconWrapper className={className}><rect width="18" height="18" x="3" y="3" rx="2" ry="2"/><circle cx="9" cy="9" r="2"/><path d="m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"/></IconWrapper>;
        const Video = ({ className }) => <IconWrapper className={className}><path d="m22 8-6 4 6 4V8Z"/><rect width="14" height="12" x="2" y="6" rx="2" ry="2"/></IconWrapper>;
        const FileIcon = ({ className }) => <IconWrapper className={className}><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/></IconWrapper>;
        const XIcon = ({ className }) => <IconWrapper className={className}><path d="M18 6 6 18"/><path d="m6 6 12 12"/></IconWrapper>;


        // --- UI COMPONENTS ---
        
        const Button = React.forwardRef(({ className, variant = "default", size = "default", ...props }, ref) => {
            const variants = {
                default: "bg-primary text-primary-foreground hover:bg-primary/90",
                destructive: "bg-destructive text-destructive-foreground hover:bg-destructive/90",
                outline: "border border-input bg-background hover:bg-accent hover:text-accent-foreground",
                secondary: "bg-secondary text-secondary-foreground hover:bg-secondary/80",
                ghost: "hover:bg-accent hover:text-accent-foreground",
                link: "text-primary underline-offset-4 hover:underline"
            };
            const sizes = {
                default: "h-10 px-4 py-2",
                sm: "h-9 rounded-md px-3",
                lg: "h-11 rounded-md px-8",
                icon: "h-10 w-10"
            };
            return (
                <button
                    ref={ref}
                    className={cn("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50", variants[variant], sizes[size], className)}
                    {...props}
                />
            );
        });

        // --- TOAST SYSTEM (Simplified) ---
        const ToastContext = createContext(null);
        
        const ToastProvider = ({ children }) => {
            const [toasts, setToasts] = useState([]);
            
            const toast = ({ title, description, variant = "default" }) => {
                const id = Math.random().toString(36).substr(2, 9);
                setToasts((prev) => [...prev, { id, title, description, variant }]);
                setTimeout(() => {
                    setToasts((prev) => prev.filter((t) => t.id !== id));
                }, 3000);
            };

            const removeToast = (id) => {
                setToasts((prev) => prev.filter((t) => t.id !== id));
            };

            return (
                <ToastContext.Provider value={{ toast }}>
                    {children}
                    <div className="toaster-viewport">
                        {toasts.map((t) => (
                            <div key={t.id} className={cn("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all mb-4", t.variant === "destructive" ? "destructive group border-destructive bg-destructive text-destructive-foreground" : "border bg-background text-foreground")}>
                                <div className="grid gap-1">
                                    {t.title && <div className="text-sm font-semibold">{t.title}</div>}
                                    {t.description && <div className="text-sm opacity-90">{t.description}</div>}
                                </div>
                                <button onClick={() => removeToast(t.id)} className="absolute right-2 top-2 rounded-md p-1 opacity-0 group-hover:opacity-100 transition-opacity hover:text-foreground">
                                    <XIcon className="h-4 w-4" />
                                </button>
                            </div>
                        ))}
                    </div>
                </ToastContext.Provider>
            );
        };

        const useToast = () => {
            const context = useContext(ToastContext);
            if (!context) throw new Error("useToast must be used within ToastProvider");
            return context;
        };

        // --- APP COMPONENTS ---

        const BackgroundOrbs = () => (
            <>
                <div className="fixed w-[400px] h-[400px] rounded-full blur-[100px] opacity-60 animate-float -z-10" style={{ background: 'hsl(186 100% 50% / 0.15)', top: '-100px', left: '-100px' }} />
                <div className="fixed w-[500px] h-[500px] rounded-full blur-[100px] opacity-60 animate-float -z-10" style={{ background: 'hsl(285 100% 50% / 0.15)', bottom: '-150px', right: '-150px', animationDelay: '-5s' }} />
            </>
        );

        const UrlInput = ({ value, onChange, onPaste }) => (
            <div className="relative flex items-center glass rounded-2xl p-1 transition-all duration-300 focus-within:border-primary focus-within:glow-primary focus-within:scale-[1.02]">
                <div className="ml-5 text-primary w-5 h-5 flex-shrink-0"><LinkIcon className="w-5 h-5"/></div>
                <input
                    type="text"
                    value={value}
                    onChange={(e) => onChange(e.target.value)}
                    placeholder="Paste your link here..."
                    className="w-full px-4 py-5 bg-transparent border-none text-foreground text-lg outline-none placeholder:text-muted-foreground"
                    autoComplete="off"
                />
                <Button type="button" variant="ghost" onClick={onPaste} className="mr-1 px-4 py-2 rounded-xl border border-border hover:bg-muted hover:text-primary transition-all">
                    <Clipboard className="w-4 h-4 mr-2" />
                    <span className="hidden sm:inline font-semibold">Paste</span>
                </Button>
            </div>
        );

        const ProgressBar = ({ progress, isVisible, status }) => {
            if (!isVisible) return null;
            return (
                <div className="mt-6 space-y-3">
                    <div className="w-full h-1.5 bg-muted rounded-full overflow-hidden">
                        <div className="h-full gradient-bg rounded-full relative glow-primary transition-all duration-300 ease-out" style={{ width: `${progress}%` }}>
                            <div className="absolute inset-0 bg-gradient-to-r from-transparent via-foreground/80 to-transparent animate-shimmer" />
                        </div>
                    </div>
                    <p className="text-center text-sm text-primary font-medium tracking-wide animate-pulse-glow">{status}</p>
                </div>
            );
        };

        const DownloadCard = ({ label, url, type = "file" }) => {
            const getIcon = () => {
                switch (type) {
                    case "video": return <Video className="w-5 h-5" />;
                    case "image": return <Image className="w-5 h-5" />;
                    case "music": return <Music className="w-5 h-5" />;
                    default: return <FileIcon className="w-5 h-5" />;
                }
            };
            return (
                <div className="glass rounded-2xl p-4 transition-all duration-300 hover:-translate-y-1 hover:bg-muted/10">
                    <a href={url} target="_blank" rel="noopener noreferrer" download className="flex items-center justify-center gap-3 w-full px-6 py-3 rounded-full border border-primary bg-primary/10 text-primary font-bold uppercase tracking-wider transition-all hover:bg-primary hover:text-primary-foreground hover:glow-primary">
                        {getIcon()}
                        {label}
                    </a>
                </div>
            );
        };

        const VideoPlayer = ({ url, label }) => {
            const [isPlaying, setIsPlaying] = useState(false);
            const [isMuted, setIsMuted] = useState(true);
            const videoRef = useRef(null);

            const togglePlay = () => {
                if (videoRef.current) {
                    if (isPlaying) videoRef.current.pause();
                    else videoRef.current.play();
                    setIsPlaying(!isPlaying);
                }
            };

            const toggleMute = () => {
                if (videoRef.current) {
                    videoRef.current.muted = !isMuted;
                    setIsMuted(!isMuted);
                }
            };

            return (
                <div className="space-y-4">
                    <div className="relative w-full max-w-[350px] mx-auto rounded-2xl overflow-hidden bg-background border border-border shadow-2xl group">
                        {!isPlaying && (
                            <div onClick={togglePlay} className="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-16 h-16 glass rounded-full flex items-center justify-center cursor-pointer z-10 transition-all duration-300 hover:scale-110 hover:bg-muted/50">
                                <Play className="w-7 h-7 text-foreground ml-1" />
                            </div>
                        )}
                        <video ref={videoRef} className="w-full max-h-[500px] object-contain bg-background" loop playsInline muted={isMuted} onClick={togglePlay}>
                            <source src={url} type="video/mp4" />
                            Your browser does not support the video tag.
                        </video>
                        <div className="absolute bottom-0 left-0 right-0 p-4 bg-gradient-to-t from-background to-transparent opacity-0 group-hover:opacity-100 transition-opacity flex justify-between items-center">
                            <Button variant="ghost" size="icon" onClick={togglePlay} className="text-foreground">
                                {isPlaying ? <Pause className="w-5 h-5" /> : <Play className="w-5 h-5" />}
                            </Button>
                            <Button variant="ghost" size="icon" onClick={toggleMute} className="text-foreground">
                                {isMuted ? <VolumeX className="w-5 h-5" /> : <Volume2 className="w-5 h-5" />}
                            </Button>
                        </div>
                    </div>
                    <a href={url} target="_blank" rel="noopener noreferrer" download className="flex items-center justify-center gap-3 w-full max-w-[350px] mx-auto px-6 py-3 rounded-full border border-primary bg-primary/10 text-primary font-bold uppercase tracking-wider transition-all hover:bg-primary hover:text-primary-foreground hover:glow-primary">
                        <Download className="w-5 h-5" />
                        Download {label}
                    </a>
                </div>
            );
        };

        const ResultArea = ({ result }) => {
            if (!result) return null;
            return (
                <div className="glass rounded-3xl p-8 animate-fade-in-up">
                    {result.title && (
                        <div className="text-center mb-6">
                            <h3 className="text-xl font-bold text-foreground">{result.title}</h3>
                            {result.author && <p className="text-sm text-muted-foreground mt-1">By {result.author}</p>}
                        </div>
                    )}
                    {result.thumbnail && (
                        <img src={result.thumbnail} alt={result.title || "Thumbnail"} className="w-full max-h-52 object-cover rounded-xl mb-6 border border-border" />
                    )}
                    <div className="space-y-6">
                        {result.videos?.map((video, index) => (
                            <VideoPlayer key={index} url={video.url} label={video.quality || `Video ${index + 1}`} />
                        ))}
                        {result.audio && <DownloadCard label="Download Audio (MP3)" url={result.audio} type="music" />}
                        {result.images?.map((imageUrl, index) => (
                            <DownloadCard key={index} label={`Download Image ${index + 1}`} url={imageUrl} type="image" />
                        ))}
                    </div>
                </div>
            );
        };

        const PlatformIcons = () => {
            const platforms = [
                { name: "Instagram", icon: "üì∏" },
                { name: "TikTok", icon: "üéµ" },
                { name: "YouTube", icon: "‚ñ∂Ô∏è" },
                { name: "Twitter/X", icon: "üê¶" },
                { name: "Facebook", icon: "üìò" },
                { name: "Spotify", icon: "üéß" },
                { name: "Pinterest", icon: "üìå" },
            ];
            return (
                <div className="flex flex-wrap justify-center gap-4 mt-8">
                    {platforms.map((platform) => (
                        <div key={platform.name} className="flex items-center gap-2 px-4 py-2 glass rounded-full text-sm text-muted-foreground hover:text-foreground hover:border-primary/50 transition-all cursor-default">
                            <span>{platform.icon}</span>
                            <span>{platform.name}</span>
                        </div>
                    ))}
                </div>
            );
        };

        // --- MAIN LOGIC (INDEX) ---

        const API_BASE = "https://socialdown.itz-ashlynn.workers.dev";

        const detectPlatform = (url) => {
            if (url.includes("instagram.com")) return "instagram";
            if (url.includes("facebook.com") || url.includes("fb.watch")) return "facebook";
            if (url.includes("tiktok.com")) return "tiktok";
            if (url.includes("twitter.com") || url.includes("x.com")) return "twitter";
            if (url.includes("youtube.com") || url.includes("youtu.be")) return "youtube";
            if (url.includes("spotify.com")) return "spotify";
            if (url.includes("pinterest.com") || url.includes("pin.it")) return "pinterest";
            if (url.includes("mediafire.com")) return "mediafire";
            if (url.includes("capcut.com")) return "capcut";
            return null;
        };

        const Index = () => {
            const [url, setUrl] = useState("");
            const [isLoading, setIsLoading] = useState(false);
            const [progress, setProgress] = useState(0);
            const [result, setResult] = useState(null);
            const [error, setError] = useState(null);
            const { toast } = useToast();

            useEffect(() => {
                let interval;
                if (isLoading && progress < 85) {
                    interval = setInterval(() => {
                        setProgress((prev) => Math.min(prev + Math.random() * 5, 85));
                    }, 100);
                }
                return () => clearInterval(interval);
            }, [isLoading, progress]);

            const handlePaste = async () => {
                try {
                    const text = await navigator.clipboard.readText();
                    if (text) setUrl(text);
                } catch {
                    toast({ title: "Paste failed", description: "Please paste the URL manually", variant: "destructive" });
                }
            };

            const processUrl = useCallback(async () => {
                if (!url.trim()) {
                    toast({ title: "No URL provided", description: "Please paste a valid URL first", variant: "destructive" });
                    return;
                }
                const platform = detectPlatform(url);
                if (!platform) {
                    toast({ title: "Unsupported platform", description: "Please try Instagram, TikTok, YouTube, Facebook, or other supported platforms", variant: "destructive" });
                    return;
                }

                setIsLoading(true);
                setProgress(0);
                setResult(null);
                setError(null);

                try {
                    let endpoint = "";
                    const params = `?url=${encodeURIComponent(url)}`;

                    if (platform === "youtube" || platform === "instagram") {
                        endpoint = platform === "youtube" ? "/yt" : "/insta";
                        const [mp4Res, mp3Res] = await Promise.all([
                            fetch(`${API_BASE}${endpoint}${params}&format=mp4`),
                            fetch(`${API_BASE}${endpoint}${params}&format=mp3`).catch(() => null),
                        ]);

                        const mp4Data = await mp4Res.json();
                        let mp3Data = null;
                        try {
                            if (mp3Res) {
                                const mp3Json = await mp3Res.json();
                                if (mp3Json.success !== false) mp3Data = mp3Json;
                            }
                        } catch { console.warn("MP3 fetch failed"); }

                        setProgress(100);

                        if (!mp4Data.success && (!mp3Data || !mp3Data.success)) {
                            throw new Error(mp4Data.error || "Failed to fetch content");
                        }

                        const videos = mp4Data.urls?.map((u) => ({ url: u })) || (mp4Data.data?.[0]?.downloadUrl ? [{ url: mp4Data.data[0].downloadUrl }] : []);
                        let audioUrl = null;
                        if (mp3Data?.audio) audioUrl = mp3Data.audio;
                        else if (mp3Data?.urls && mp3Data.urls.length > 0) audioUrl = mp3Data.urls[0];
                        else if (mp3Data?.data?.[0]?.downloadUrl) audioUrl = mp3Data.data[0].downloadUrl;
                        else if (mp4Data.audio) audioUrl = mp4Data.audio;

                        setResult({
                            platform,
                            title: mp4Data.data?.[0]?.title || `${platform.charAt(0).toUpperCase() + platform.slice(1)} Content`,
                            videos,
                            audio: audioUrl,
                        });
                        setUrl("");
                        return;
                    }

                    switch (platform) {
                        case "facebook": endpoint = "/fb"; break;
                        case "tiktok": endpoint = "/tiktok"; break;
                        case "twitter": endpoint = "/x"; break;
                        case "spotify": endpoint = "/spotify"; break;
                        case "pinterest": endpoint = "/pinterest"; break;
                        case "mediafire": endpoint = "/mediafire"; break;
                        case "capcut": endpoint = "/capcut"; break;
                    }

                    const response = await fetch(`${API_BASE}${endpoint}${params}`);
                    const data = await response.json();
                    setProgress(100);

                    if (data.success === false || data.error) throw new Error(data.error || "Failed to fetch content");

                    let processedResult = { platform };

                    switch (platform) {
                        case "facebook":
                            processedResult.videos = data.hd ? [{ url: data.hd, quality: "HD" }] : data.sd ? [{ url: data.sd, quality: "SD" }] : [];
                            processedResult.audio = data.audio;
                            break;
                        case "tiktok":
                            const tikVid = data.data?.[0];
                            if (tikVid) {
                                processedResult.title = tikVid.title;
                                processedResult.videos = tikVid.downloadLinks?.map((l) => ({ url: l.link })) || [];
                            }
                            break;
                        case "twitter":
                            if (data.found && data.media) {
                                processedResult.author = data.authorUsername;
                                processedResult.videos = data.media.filter((m) => m.type === "video").map((m) => ({ url: m.url }));
                                processedResult.images = data.media.filter((m) => m.type !== "video").map((m) => m.url);
                            }
                            break;
                        case "spotify":
                            processedResult.title = data.name;
                            processedResult.author = data.artists?.join(", ");
                            processedResult.thumbnail = data.image;
                            processedResult.audio = data.download_url;
                            break;
                        case "pinterest":
                            if (data.medias) {
                                processedResult.title = data.title;
                                processedResult.videos = data.medias.filter((m) => m.extension === "mp4").map((m) => ({ url: m.url, quality: m.quality }));
                                processedResult.images = data.medias.filter((m) => m.extension !== "mp4").map((m) => m.url);
                            }
                            break;
                        case "mediafire":
                            processedResult.title = data.name;
                            processedResult.audio = data.download;
                            break;
                        case "capcut":
                            processedResult.title = data.title;
                            processedResult.author = data.author;
                            processedResult.thumbnail = data.coverUrl;
                            break;
                    }

                    setResult(processedResult);
                    setUrl("");

                } catch (err) {
                    const message = err.message || "Connection failed. Please try again.";
                    setError(message);
                    toast({ title: "Error", description: message, variant: "destructive" });
                } finally {
                    setIsLoading(false);
                    setTimeout(() => setProgress(0), 500);
                }
            }, [url, toast]);

            return (
                <div className="min-h-screen flex flex-col items-center overflow-x-hidden relative px-4 py-8">
                    <BackgroundOrbs />
                    <header className="text-center pt-8 pb-6 animate-fade-in-up">
                        <h1 className="text-4xl sm:text-5xl font-extrabold uppercase tracking-widest text-gradient flex items-center justify-center gap-3 drop-shadow-lg">
                            <Zap className="w-10 h-10 text-primary" /> Solox
                        </h1>
                        <p className="text-muted-foreground mt-2 tracking-wider">Universal Social Media Downloader</p>
                    </header>
                    <main className="w-full max-w-[650px] glass rounded-3xl p-6 sm:p-10 shadow-2xl transition-all duration-400 hover:shadow-primary/10 hover:border-primary/30 animate-fade-in-up" style={{ animationDelay: "0.2s" }}>
                        <UrlInput value={url} onChange={setUrl} onPaste={handlePaste} />
                        <Button onClick={processUrl} disabled={isLoading} className="w-full mt-6 py-6 text-lg font-extrabold uppercase tracking-widest gradient-bg animate-gradient border-0 text-foreground hover:scale-[1.02] hover:glow-primary transition-all disabled:opacity-70">
                            {isLoading ? "Processing..." : "Get Content"}
                        </Button>
                        <ProgressBar progress={progress} isVisible={isLoading} status="Fetching data..." />
                        {error && <div className="mt-6 p-4 rounded-xl bg-destructive/10 border border-destructive/30 text-destructive text-center backdrop-blur-sm">{error}</div>}
                    </main>
                    {result && <div className="w-full max-w-[650px] mt-6 animate-fade-in-up"><ResultArea result={result} /></div>}
                    <footer className="mt-auto pt-12 pb-6 text-center animate-fade-in-up" style={{ animationDelay: "0.4s" }}>
                        <PlatformIcons />
                        <p className="text-muted-foreground/50 text-sm mt-6">¬© 2024 Solox Web</p>
                    </footer>
                </div>
            );
        };

        const App = () => (
            <ToastProvider>
                <Index />
            </ToastProvider>
        );

        const root = ReactDOM.createRoot(document.getElementById("root"));
        root.render(<App />);
    </script>
</body>
</html>

